#azure #azure-wda #csharp 

# Application Pattern - Human Interaction
Many automated process involve some kind of human interaction.
Involving humans is tricky as they aren't as highly available as cloud services.
An automated process might allow for this interaction using timeouts and ==compensation logic==.
![[Human Interaction Diagram.png]]

Can implement this pattern using an orchestration function.
Orchestrator uses a durable timer to request approval.
Orchestrator ==escalates== if timeout occurs.
Orchestrator waits for an external event, such as notification that's generated by a human interaction.
```cs
[FunctionName("ApprovalWorkflow")]
public static async Task Run(
	[OrchestrationTrigger]
	IDurableOrchestrationContext context)
{
	await context.CallActivityAsync("RequestApproval", null);
	using var timeoutCts = new CancellationTokenSource();
	var dueTime = context.CurrentUtcDateTime.AddHours(72);
	var durableTimeout = context.CreateTimer(dueTime, timeoutCts.Token);

	var approvalEvent = context.WaitForExternalEvent<bool>("ApprovalEvent");
	if (approvalEvent == await Task.WhenAny(approvalEvent, durableTimeout))
	{
		timeoutCts.Cancel();
		await context.CallActivityAsync("ProcessApproval", approvalEvent.Result);
	}
	else
	{
		await context.CallActivityAsync("Escalate", null);
	}
}
```
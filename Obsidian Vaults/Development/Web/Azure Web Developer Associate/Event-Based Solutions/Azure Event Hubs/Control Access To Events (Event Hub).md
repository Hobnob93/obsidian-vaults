#azure #az-204 

## Overview
Azure Event Hubs supports [[About Azure Active Directory|Azure Active Directory]] and [[Shared Access Signatures]] (SAS).
They handle authentication and authorisation.
Built-in roles are provided for authorising access to Event Hubs data using AAD and OAuth:
- Azure Event Hubs Data Owner
	- Complete access to Event Hubs resources
- Azure Event Hubs Data Sender
	- Send access to Event Hubs resources
- Azure Event Hubs Data Receiver
	- Receiving access to Event Hubs resources

## Authorise Access With Managed Identities
To authorise a request to hubs from a [[Managed Identities|Managed Identity]] in your app, you need to configure role-based access control settings for that managed identity.
Hubs defines roles that encompass permissions for sending and reading from Event Hubs.
When the role is assigned to a managed identity, the identity is granted access to Hubs data at the appropriate scope.

## Authorise Access With Microsoft Identity Platform
An advantage using AAD with Hubs is your credentials no longer need to be stored in your code.
You can instead request an OAuth 2.0 access token from [[About Microsoft identity Platform|Microsoft Identity Platform]].
AAD authenticates the security principal (user, group, or [[Explore Service Principals|service principal]]) running the application.
If auth succeeds, AAD returns the access token to the app, which can then use it to authorise requests to Hubs.

## Authorise Access To Event Hubs Publishers With Shared Access Signatures
An event publisher defines a virtual endpoint for a hub.
Publisher can only be used to send messages to a hub and not receive messages.
Typically, a hub employs one publisher per client.
All messages sent to any publishers of an event hub are enqueued within that hub.
Publishers enable fine-grained access control.

Each hub client is assigned a unique token which is uploaded to the client.
A client with a token can only send to one publisher, and no other publisher.
If multiple clients share the same token, each of them shares the publisher.

All tokens are assigned with [[Shared Access Signatures|shared access signature]] keys.
Typically, all tokens are signed with the same key.
Clients aren't aware of the key, which prevents clients from manufacturing tokens.
Clients operate on the same tokens until they expire.

## Authorise Access To Event Hubs Consumers With Shared Access Signatures
To authenticate backend applications that consume from data generated by Hubs producers, Hubs token authentication requires clients to either have the `manage` rights or `listen` privileges assigned to its Hubs namespace or event hub instance or topic.
Data is consumed from Hubs using consumer groups.
While SAS policy gives you granular scope, its defined only at the entity level and not the consumer level.
This means the privileges defined at namespace level or hub instance or topic level will be applied to the consumer groups of that entity.